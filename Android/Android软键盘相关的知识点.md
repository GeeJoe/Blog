# Android 软键盘相关的知识点



在处理 Android 软件盘相关的逻辑的时候，常常会遇到一些奇奇怪怪的问题，比如当软件盘弹起的时候，顶部 bar 被顶出屏幕之外、当退出编辑页面，软键盘还没有收起来等等这样的问题，这些问题的发生往往是因为我们没有正确设置 `Window` 的 `softInputMode`，下面就记录一下 `softInputMode` 可以设置哪些值，以及这些值分别代表什么意思

`softInputMode` 可以分为两大类，一类控制当 `Window` 获取焦点后，软键盘隐藏与显示，以 `state` 开头

-----------------------------------------------------------------------------------------------------------------------------

**1. stateUnspecified**    
不指定软键盘的状态（隐藏还是可见）将由系统选择合适的状态，或依赖主题中的设置，这是对软键盘行为的默认设置

**2. stateUnchanged**  
保留状态
当 Activity 转至前台时保留软键盘最后所处的任何状态，无论是可见还是隐藏

**3. stateHidden**     
当用户确实是向前导航到 Activity，而不是因离开另一 Activity 而返回时隐藏软键盘

**4. stateAlwaysHidden**   
始终隐藏软键盘，当 Activity 的主窗口有输入焦点时始终隐藏软键盘

**5. stateVisible**    
显示软键盘，在正常的适宜情况下（当用户向前导航到 Activity 的主窗口时）显示软键盘

**6. stateAlwaysVisible**      
始终显示软键盘，当用户确实是向前导航到 Activity，而不是因离开另一 Activity 而返回时显示软键盘   

第二类控制当软键盘弹出时，`Window` 的调整策略，以 `adjust` 开头

--------------------------------------------
**1. adjustUnspecified**    
主窗口的默认行为，不指定 Activity 的主窗口是否调整尺寸以为软键盘腾出空间，或者窗口内容是否进行平移以在屏幕上显露当前焦点。 系统会根据窗口的内容是否存在任何可滚动其内容的布局视图来自动选择其中一种模式。 如果存在这样的视图，窗口将进行尺寸调整，前提是可通过滚动在较小区域内看到窗口的所有内容。

**2. adjustResize**    
始终调整 Activity 主窗口的尺寸来为屏幕上的软键盘腾出空间。当软键盘弹出时，会让布局重新绘制，这种一般适应于带有滑动性质的控制，让其向下滚动，然后适应软键盘的显示。

**3. adjustPan**    
不调整 Activity 主窗口的尺寸来为软键盘腾出空间， 而是自动平移窗口的内容，使当前焦点永远不被键盘遮盖，让用户始终都能看到其输入的内容。 这通常不如尺寸调整可取，因为用户可能需要关闭软键盘以到达被遮盖的窗口部分或与这些部分进行交互。

**4. adjustNoting**     
软键盘弹出时，主窗口 Activity 不会做出任何响应。

